@page "/paymentsInfo"
@using AlriyadahBMS.Services
@using AlriyadahBMS.Shared.ViewModels


@inject IDialogService Dialog
@inject TableService tableService
@inject LocalizationService Language


<PageLayout Title="@Language.Phrase("tblbillinginfo", "tblcaption")">

    <MudTable Items="@tblPaymentsRecord" Dense="false" Hover="true" ReadOnly="false" CanCancelEdit="false" Filter="new Func<PaymentsModel,bool>(FilterFunc)"
              SortLabel="Sort By">
        <ToolBarContent>
            @* <MudText Typo="Typo.h6">Payments</MudText> *@
            <MudSpacer />
            <MudTextField @bind-Value="searchString" Placeholder="@Language.Phrase("buttonsearch")" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
        </ToolBarContent>

        <HeaderContent>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<PaymentsModel, object>(x=>x.NationalID)">@Language.Phrase("tblbillinginfo", "nationalid", "fldcaption")</MudTableSortLabel></MudTh>
                <MudTh><MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.str_First_Name)">@Language.Phrase("tblstudents", "str_first_name", "fldcaption")</MudTableSortLabel></MudTh>
                <MudTh><MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.str_Last_Name)">@Language.Phrase("tblstudents", "str_last_name", "fldcaption")</MudTableSortLabel></MudTh>
                <MudTh><MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.date_Paid)">@Language.Phrase("billing_status", "date_paid", "fldcaption")</MudTableSortLabel></MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.str_ApprovalCode)">
                        @Language.Phrase("tblbillinginfo", "str_approvalcode", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.Payment_Number)">
                    @Language.Phrase("tblbillinginfo", "payment_number", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.Pricelist)">
                    @Language.Phrase("tblbillinginfo", "pricelist", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.str_Amount_Pay)">
                    @Language.Phrase("tblbillinginfo", "str_amount_pay_updated", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.mny_Running_Payments)">
                    @Language.Phrase("tblbillinginfo", "mny_running_payments", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<PaymentsModel, object>(x=>x.mny_Running_Balance)">
                    @Language.Phrase("tblbillinginfo", "mny_running_balance", "fldcaption")
                    </MudTableSortLabel>
                </MudTh>

            <MudTh>@Language.Phrase("tblstudents", "student_action", "fldcaption")</MudTh>

            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "nationalid", "fldcaption")">@context.NationalID</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblstudents", "str_first_name", "fldcaption")">@context.str_First_Name</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblstudents", "str_last_name", "fldcaption")">@context.str_Last_Name</MudTd>
                <MudTd DataLabel="@Language.Phrase("billing_status", "date_paid", "fldcaption")">@context.date_Paid</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "str_approvalcode", "fldcaption")">@context.str_ApprovalCode</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "payment_number", "fldcaption")">@context.Payment_Number</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "pricelist", "fldcaption")">@context.Pricelist</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "str_amount_pay_updated", "fldcaption")">@context.str_Amount_Pay</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "mny_running_payments", "fldcaption")">@context.mny_Running_Payments</MudTd>
                <MudTd DataLabel="@Language.Phrase("tblbillinginfo", "mny_running_balance", "fldcaption")">@context.mny_Running_Balance</MudTd>
                <MudTd>
                    <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.RemoveRedEye" OnClick="(()=> OnClick_PaymentsDetails(context))" />
                    <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.Edit" OnClick="(()=> OnClick_PaymentsEditDetails(context))" />
                    @* <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.Delete" /> *@
                </MudTd>

            </RowTemplate>
            <PagerContent>
                <MudTablePager />
            </PagerContent>
        </MudTable>

    </PageLayout>




